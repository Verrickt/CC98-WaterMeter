<ui:FluentWindow x:Class="WaterMeter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WaterMeter"
        mc:Ignorable="d"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        Icon="pack://application:,,,/Assets/98icon.png"
        WindowStartupLocation="CenterScreen"
        FontFamily="Microsoft YaHei"
        FontSize="10"
        MinHeight="550"
        MinWidth="910"
        Title="水表助手" Height="600" Width="1024">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
        </Grid.RowDefinitions>
        <ui:TitleBar
            Title="水表助手"

            >
            <ui:TitleBar.Icon>
                <ui:ImageIcon Source="pack://application:,,,/Assets/98icon.png" />
            </ui:TitleBar.Icon>
        </ui:TitleBar>
        <Grid Grid.Row="1" Grid.RowSpan="2" Margin="10,0,10,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="550"></ColumnDefinition>
                <ColumnDefinition Width="*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid Margin="0,0,0,5" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition></RowDefinition>
                </Grid.RowDefinitions>
                <Label  FontSize="14">日志</Label>
                <ScrollViewer  Grid.Row="1" x:Name="ScrollViewer">
                    <TextBox TextWrapping="Wrap" IsReadOnly="True"  x:Name="LogTextBlock"></TextBox>
                </ScrollViewer>
            </Grid>

            <Grid Grid.Column="1" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition></RowDefinition>
                </Grid.RowDefinitions>
                <StackPanel Margin="5,0,5,0">
                    <Label Margin="5" FontSize="14">配置</Label>
                    <Label Margin="5">帖子ID</Label>
                    <ui:TextBox PlaceholderText="目标帖子的ID"
                                ToolTipService.ToolTip="你要统计的帖子的ID"
                                PlaceholderEnabled="True"  Margin="5" Text="{Binding TopicId,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"></ui:TextBox>
                    <Label Margin="5">RefreshToken</Label>
                    <ui:PasswordBox Margin="5"
                                PlaceholderEnabled="True"
                                PlaceholderText="网页版的AccessToken，用于调用98API。请勿泄露"
                                ToolTipService.ToolTip="拥有AccessToken的人可以您的身份调用98API，请勿泄露。从网页端的LocalStorage中获取。"
                                Password="{Binding RefreshToken,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"></ui:PasswordBox>
                    <Label Margin="5">访问间隔（秒）</Label>
                    <ui:TextBox PlaceholderEnabled="True" PlaceholderText="调用98API的时间间隔，大于3的正整数"
                                ToolTipService.ToolTip="必须为大于3的正整数。"
                                Margin="5" Text="{Binding Interval,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"></ui:TextBox>
                    <Label Margin="5">当前楼层</Label>
                    <TextBox Margin="5" IsEnabled="False" Text="{Binding CurrentFloor,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"></TextBox>
                    <Label Margin="5">总楼层数</Label>
                    <TextBox Margin="5" IsEnabled="False" Text="{Binding MaxFloor,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"></TextBox>
                    <StackPanel Orientation="Horizontal">
                        <Button  Margin="5" Command="{Binding SaveConfigCommand}" >保存设置</Button>
                        <Button Margin="5" Command="{Binding OpenConfigDirCommand}">打开配置目录</Button>
                        <Button  Margin="5" ToolTipService.ToolTip="补全不在缓存中的楼层" Command="{Binding ResetCurrentFloorCommand}" >补全空余楼层</Button>
                        <ui:Anchor Icon="{ui:SymbolIcon Link24}" NavigateUri="https://www.github.com/verrickt/WaterMeter" Margin="5" >关于</ui:Anchor>
                    </StackPanel>
                </StackPanel>

                <StackPanel Margin="5,0,5,0"  VerticalAlignment="Bottom" HorizontalAlignment="Left" Orientation="Horizontal"  Grid.Row="1">
                    <ui:Button Appearance="Primary" Margin="5" Command="{Binding StartOverWatchCommand}">开始守望</ui:Button>
                    <Button Margin="5" Command="{Binding StopOverWatchCommand}">停止守望</Button>
                    <Button Margin="5" Command="{Binding GenerateStatCommand}">统计成年用户</Button>
                </StackPanel>
            </Grid>
        </Grid>
        <ui:SnackbarPresenter x:Name="SnackbarPresenter" Grid.Row="2">
        </ui:SnackbarPresenter>
    </Grid>
</ui:FluentWindow>
